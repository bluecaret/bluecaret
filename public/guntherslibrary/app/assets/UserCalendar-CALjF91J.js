import{d as Y,u as R,r as A,o as H,c as m,a as i,b as r,w as h,v as x,f as l,n as y,e as u,k as q,m as S,F as c,g as p,i as v,h as M,j as D,I as K,t as f,H as B,A as J,G as Q,p as E,q as X,s as Z,C as _,_ as aa}from"./index-crzrhOP4.js";import{f as ea,o as j}from"./objects-VhMafjU8.js";const na={class:"mainList"},ra={class:"notesBox box twigsLight"},ta={class:"boxContent",style:{"padding-block-end":"0.8rem"}},la={class:"calendarMonthForm tagGroup tagGroupSpan"},sa={class:"calendarYearInput"},oa={class:"calendarDayForm"},ia={class:"selectWrapper"},ma=["value"],da={class:"calendar"},ua=["data-day","onClick"],ca={class:"tagGroup"},fa={class:"miniLabel"},ya={key:0,class:"loveList"},va={key:0},pa=["onClick"],ba={class:"form addEventForm"},ha={class:"field addEventFieldIcon"},ga={"aria-labelledby":"newEventIcon",popovertarget:"iconPopover",class:"newEventIcon btn block tertiary"},ka={id:"iconPopover",class:"iconPopover",popover:"manual"},Ea={class:"iconPopoverInner"},Ca={popovertarget:"iconPopover",popovertargetaction:"hide",class:"close"},wa={class:"eventIconList"},Fa=["onClick"],Sa={class:"field addEventFieldTitle"},_a={class:"field addEventFieldYear"},ja={class:"field addEventFieldMonth"},Ia={id:"newEventMonth",class:"label"},xa={"aria-labelledby":"newEventMonth",class:"calendarMonthForm tagGroup tagGroupSpan"},Ma={class:"field addEventFieldDay"},Da=["value"],Wa={class:"field addEventFieldTime"},Aa=["value"],Ba={class:"field addEventFieldRepeats"},Ta={value:"weekly"},$a={value:"monthly"},Oa={value:"yearly"},Ua=Y({__name:"UserCalendar",setup(Va){const a=R(),C=["Spring","Summer","Fall","Winter"],g={Spring:0,Summer:1,Fall:2,Winter:3},w={id:btoa("event_"+new Date(Math.ceil(Math.random()*1e13)).getTime()),title:"",month:"Spring",day:1,time:"allDay",year:1,icon:"flag",recurrence:"none"},s=A(w),k=A(!1),W=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],T=()=>{k.value=!1,s.value={...w},s.value.year=a.farms[a.farm].calendar.year,s.value.month=a.farms[a.farm].calendar.month,s.value.day=a.farms[a.farm].calendar.day,a.openModal("calendarAdd")},$=()=>{(!s.value.year||s.value.year<1)&&(s.value.year=1),a.farms[a.farm].calendarEvents.push({id:btoa("event_"+new Date(Math.ceil(Math.random()*1e13)).getTime()),title:s.value.title,month:s.value.month,day:s.value.day,year:s.value.year,time:s.value.time||void 0,recurrence:s.value.recurrence,icon:s.value.icon}),a.saveFarms(),a.closeModal(),s.value=w},O=()=>{k.value=!1,s.value=w,a.closeModal()},U=o=>{s.value={...o},k.value=!0,a.openModal("calendarAdd")},V=()=>{if(!s.value)return;(!s.value.year||s.value.year<1)&&(s.value.year=1);const o=a.farms[a.farm].calendarEvents.findIndex(e=>{var t;return e.id===((t=s.value)==null?void 0:t.id)});o!==-1&&(a.farms[a.farm].calendarEvents[o]={...s.value},a.saveFarms()),a.closeModal(),k.value=!1},G=o=>{const e=a.farms[a.farm].calendarEvents.findIndex(t=>t.id===o.id);e!==-1&&(a.farms[a.farm].calendarEvents.splice(e,1),a.saveFarms()),a.closeModal()};function F(o){const e=[];return a.settings.app.showBuiltInEvents&&e.push(...Q),a.farms[a.farm].calendarEvents&&e.push(...a.farms[a.farm].calendarEvents),e.filter(t=>{if(t.month===a.farms[a.farm].calendar.month&&t.day===o&&t.year===a.farms[a.farm].calendar.year)return!0;switch(t.recurrence){case"daily":return t.year<a.farms[a.farm].calendar.year||t.year===a.farms[a.farm].calendar.year&&g[t.month]<g[a.farms[a.farm].calendar.month]||t.year===a.farms[a.farm].calendar.year&&t.month===a.farms[a.farm].calendar.month&&t.day<o;case"weekly":return t.year<a.farms[a.farm].calendar.year&&b(t.day)===b(o)||t.year===a.farms[a.farm].calendar.year&&g[t.month]<g[a.farms[a.farm].calendar.month]&&b(t.day)===b(o)||t.year===a.farms[a.farm].calendar.year&&t.month===a.farms[a.farm].calendar.month&&t.day<=o&&b(t.day)===b(o);case"monthly":return t.year<a.farms[a.farm].calendar.year&&t.day===o||t.year===a.farms[a.farm].calendar.year&&g[t.month]<g[a.farms[a.farm].calendar.month]&&t.day===o||t.year===a.farms[a.farm].calendar.year&&t.month===a.farms[a.farm].calendar.month&&t.day===o;case"yearly":return t.year<a.farms[a.farm].calendar.year&&t.day===o&&t.month===a.farms[a.farm].calendar.month||t.year===a.farms[a.farm].calendar.year&&t.day===o&&t.month===a.farms[a.farm].calendar.month;default:return!1}})}const b=o=>{var e;return(e=W[(o-1)%7])!=null?e:""},z=()=>{const o=a.farms[a.farm].calendar.day;o>1?a.farms[a.farm].calendar.day=o-1:(a.farms[a.farm].calendar.month==="Spring"&&(a.farms[a.farm].calendar.year-=1,a.farms[a.farm].calendar.year<1&&(a.farms[a.farm].calendar.year=1)),a.farms[a.farm].calendar.day=28,a.farms[a.farm].calendar.month=C[(C.indexOf(a.farms[a.farm].calendar.month)+3)%4]),a.saveFarms()},N=()=>{const o=a.farms[a.farm].calendar.day;o<28?a.farms[a.farm].calendar.day=o+1:(a.farms[a.farm].calendar.month==="Winter"&&(a.farms[a.farm].calendar.year+=1),a.farms[a.farm].calendar.day=1,a.farms[a.farm].calendar.month=C[(C.indexOf(a.farms[a.farm].calendar.month)+1)%4]),a.saveFarms()},P=o=>o.builtIn&&o.title.includes("Birthday"),L=o=>{if(o.builtIn&&o.title.includes("Birthday")){const e=a.villager[o.id.charAt(0).toUpperCase()+o.id.slice(1)];return e?e.giftItems.love||[]:[]}};return H(()=>{a.header={hideIcon:!1,hideUp:!0,iconName:"calendar",iconSize:"2",label:"Calendar",bookmark:{appType:"page",id:"calendar",name:"Calendar",link:"/gunther/calendar",icon:"calendar",scale:3}}}),(o,e)=>{const t=q("icon");return i(),m("main",null,[r("div",na,[r("div",ra,[r("div",ta,[r("div",la,[r("div",sa,[e[19]||(e[19]=r("label",{for:"calendarYear"},"Year",-1)),h(r("input",{type:"number",id:"calendarYear","onUpdate:modelValue":e[0]||(e[0]=n=>l(a).farms[l(a).farm].calendar.year=n),onChange:e[1]||(e[1]=n=>l(a).saveFarms()),class:"input",min:"1"},null,544),[[x,l(a).farms[l(a).farm].calendar.year]])]),r("button",{class:y(["btn tertiary",{active:l(a).farms[l(a).farm].calendar.month==="Spring"}]),onClick:e[2]||(e[2]=()=>{l(a).farms[l(a).farm].calendar.month="Spring",l(a).saveFarms()}),"aria-label":"Spring"},[u(t,{name:"season-spring"})],2),r("button",{class:y(["btn tertiary",{active:l(a).farms[l(a).farm].calendar.month==="Summer"}]),onClick:e[3]||(e[3]=()=>{l(a).farms[l(a).farm].calendar.month="Summer",l(a).saveFarms()}),"aria-label":"Summer"},[u(t,{name:"season-summer"})],2),r("button",{class:y(["btn tertiary",{active:l(a).farms[l(a).farm].calendar.month==="Fall"}]),onClick:e[4]||(e[4]=()=>{l(a).farms[l(a).farm].calendar.month="Fall",l(a).saveFarms()}),"aria-label":"Fall"},[u(t,{name:"season-fall"})],2),r("button",{class:y(["btn tertiary",{active:l(a).farms[l(a).farm].calendar.month==="Winter"}]),onClick:e[5]||(e[5]=()=>{l(a).farms[l(a).farm].calendar.month="Winter",l(a).saveFarms()}),"aria-label":"Winter"},[u(t,{name:"season-winter"})],2)]),r("div",oa,[r("button",{class:"btn tertiary","aria-label":"Go to previous day",onClick:z},[u(t,{name:"arrow-outline-left"})]),r("div",ia,[h(r("select",{class:"select",id:"dayOfMonth","aria-label":"Day of month","onUpdate:modelValue":e[6]||(e[6]=n=>l(a).farms[l(a).farm].calendar.day=n),onChange:e[7]||(e[7]=n=>l(a).saveFarms())},[(i(),m(c,null,p(28,n=>r("option",{key:n,value:n},f(l(j)(n))+" of "+f(l(a).farms[l(a).farm].calendar.month),9,ma)),64))],544),[[S,l(a).farms[l(a).farm].calendar.day]])]),r("button",{class:"btn tertiary","aria-label":"Go to next day",onClick:N},[u(t,{name:"arrow-outline-right"})]),r("button",{class:y(["btn tertiary",{active:l(a).settings.app.showBuiltInEvents}]),style:{"padding-inline":"0"},"aria-label":"Show built-in events",onClick:e[8]||(e[8]=n=>l(a).settings.app.showBuiltInEvents=!l(a).settings.app.showBuiltInEvents)},[u(t,{name:"flag"})],2)]),r("div",da,[(i(),m(c,null,p(W,n=>r("div",{key:n,class:"calendarDay day"},f(n),1)),64)),(i(),m(c,null,p(28,n=>r("div",{key:n,class:y(["calendarDay",{active:l(a).farms[l(a).farm].calendar.day===n}]),"data-day":n,onClick:()=>{l(a).farms[l(a).farm].calendar.day=n,l(a).saveFarms()}},[(i(!0),m(c,null,p(F(n),(d,I)=>(i(),m(c,{key:d.id},[d.icon&&I<2?(i(),E(t,{key:0,name:d.icon,trim:!1,size:"2"},null,8,["name"])):v("",!0)],64))),128)),F(n).length>2?(i(),E(t,{key:0,class:"more",name:"plus",size:1.5,trim:!1})):v("",!0)],10,ua)),64))]),r("div",ca,[F(l(a).farms[l(a).farm].calendar.day).length>0?(i(!0),m(c,{key:0},p(F(l(a).farms[l(a).farm].calendar.day),n=>(i(),m("div",{key:n.id,class:"tag tagBlock",style:{"grid-template":"auto / 3.2rem 1fr 3.2rem"}},[n.icon?(i(),E(t,{key:0,name:n.icon,trim:!1},null,8,["name"])):v("",!0),r("div",fa,[D(f(n.time!=="allDay"?"[".concat(l(B).find(d=>d.time24===n.time).time12,"]  "):"")+f(n.title)+" ",1),P(n)?(i(),m("div",ya,[(i(!0),m(c,null,p(L(n),(d,I)=>(i(),m(c,{key:I},[d.universal?v("",!0):(i(),m("div",va,[d.sprite?(i(),m("div",{key:0,class:"appIcon",style:X(l(Z)({index:d.sprite,texture:d.texture,scale:1}))},null,4)):d.category&&d.category.startsWith("-")&&l(_)[d.category]?(i(),E(t,{key:1,class:"appIcon",name:l(_)[d.category].icon,size:"1"},null,8,["name"])):d.context&&l(_)["context-".concat(d.context.toLowerCase().replaceAll(" ","_"))]?(i(),E(t,{key:2,class:"appIcon",name:l(_)["context-".concat(d.context.toLowerCase().replaceAll(" ","_"))].icon,size:"1"},null,8,["name"])):v("",!0)]))],64))),128))])):v("",!0)]),n.builtIn?v("",!0):(i(),m("button",{key:1,class:"btn tertiary",onClick:d=>U(n),style:{padding:"0","min-height":"100%"},"aria-label":"Edit event"},[u(t,{name:"pencil",size:"1.5"})],8,pa))]))),128)):v("",!0),u(J,{"modal-id":"calendarAdd",class:"tagBlock",title:"Add Calendar Event",height:"auto"},{button:M(()=>[r("button",{class:"btn block",onClick:T},"Add event")]),body:M(()=>[r("div",ba,[r("div",ha,[e[21]||(e[21]=r("label",{id:"newEventIcon",class:"label"},"Icon",-1)),r("button",ga,[u(t,{name:s.value.icon,trim:!1},null,8,["name"])]),r("dialog",ka,[r("div",Ea,[r("button",Ca,[u(t,{name:"rustic-x",size:"1.5"})]),e[20]||(e[20]=r("h3",null,"Select an icon to represent your event.",-1)),r("div",wa,[(i(!0),m(c,null,p(l(K),n=>(i(),m(c,{key:n.name},[!["no-icon","junimo-green-1","junimo-green-3","junimo-green-4","junimo-green-5","junimo-blue-1","junimo-blue-3","junimo-blue-4","junimo-blue-5","junimo-red-1","junimo-red-3","junimo-red-4","junimo-red-5","junimo-purple-1","junimo-purple-3","junimo-purple-4","junimo-purple-5","junimo-yellow-1","junimo-yellow-3","junimo-yellow-4","junimo-yellow-5","junimo-orange-1","junimo-orange-3","junimo-orange-4","junimo-orange-5","junimo-gray-1","junimo-gray-3","junimo-gray-4","junimo-gray-5"].includes(n.name)&&!["People and Creatures","Prairie King"].includes(n.category)&&!(["Pets"].includes(n.category)&&n.name.startsWith("npc-"))&&!n.name.startsWith("avatar-")?(i(),m("button",{key:0,popovertarget:"iconPopover",popovertargetaction:"hide",class:y(["eventIconOption note",{parchment:s.value.icon===n.name}]),onClick:d=>s.value.icon=n.name},[u(t,{name:n.name,trim:!1},null,8,["name"])],10,Fa)):v("",!0)],64))),128))])])])]),r("div",Sa,[e[22]||(e[22]=r("label",{for:"newEventTitle",class:"label"},"Title",-1)),h(r("input",{type:"text",id:"newEventTitle","onUpdate:modelValue":e[9]||(e[9]=n=>s.value.title=n),class:"input"},null,512),[[x,s.value.title]])]),r("div",_a,[e[23]||(e[23]=r("label",{for:"newEventYear",class:"label"},"Year",-1)),h(r("input",{type:"number",id:"newEventYear","onUpdate:modelValue":e[10]||(e[10]=n=>s.value.year=n),class:"input",min:"1"},null,512),[[x,s.value.year]])]),r("div",ja,[r("div",Ia,"Month: "+f(s.value.month),1),r("div",xa,[r("button",{class:y(["btn tertiary",{active:s.value.month==="Spring"}]),onClick:e[11]||(e[11]=n=>s.value.month="Spring"),"aria-label":"Spring"},[u(t,{name:"season-spring"})],2),r("button",{class:y(["btn tertiary",{active:s.value.month==="Summer"}]),onClick:e[12]||(e[12]=n=>s.value.month="Summer"),"aria-label":"Summer"},[u(t,{name:"season-summer"})],2),r("button",{class:y(["btn tertiary",{active:s.value.month==="Fall"}]),onClick:e[13]||(e[13]=n=>s.value.month="Fall"),"aria-label":"Fall"},[u(t,{name:"season-fall"})],2),r("button",{class:y(["btn tertiary",{active:s.value.month==="Winter"}]),onClick:e[14]||(e[14]=n=>s.value.month="Winter"),"aria-label":"Winter"},[u(t,{name:"season-winter"})],2)])]),r("div",Ma,[e[24]||(e[24]=r("label",{for:"newEventDay",class:"label"},"Day",-1)),h(r("select",{class:"select",id:"newEventDay","onUpdate:modelValue":e[15]||(e[15]=n=>s.value.day=n)},[(i(),m(c,null,p(28,n=>r("option",{key:n,value:n},f(l(j)(n))+", "+f(b(n)),9,Da)),64))],512),[[S,s.value.day]])]),r("div",Wa,[e[26]||(e[26]=r("label",{for:"newEventDay",class:"label"},"Time",-1)),h(r("select",{id:"newEventDay","onUpdate:modelValue":e[16]||(e[16]=n=>s.value.time=n),class:"select"},[e[25]||(e[25]=r("option",{value:"allDay"},"All day",-1)),(i(!0),m(c,null,p(l(B),n=>(i(),m(c,{key:n.time24},[n.time24!=="2600"?(i(),m("option",{key:0,value:n.time24},f(n.time12),9,Aa)):v("",!0)],64))),128))],512),[[S,s.value.time]])]),r("div",Ba,[e[29]||(e[29]=r("label",{for:"newEventDay",class:"label"},"Repeats",-1)),h(r("select",{class:"select",id:"newEventDay","onUpdate:modelValue":e[17]||(e[17]=n=>s.value.recurrence=n)},[e[27]||(e[27]=r("option",{value:"none"},"Does not repeat",-1)),e[28]||(e[28]=r("option",{value:"daily"},"Every day",-1)),r("option",Ta,"Every "+f(l(ea)(b(s.value.day))),1),r("option",$a,"Every "+f(l(j)(s.value.day)),1),r("option",Oa,"Every year on "+f(l(j)(s.value.day))+" of "+f(s.value.month),1)],512),[[S,s.value.recurrence]])])])]),footer:M(()=>[r("button",{class:"btn block tertiary",onClick:O},"Close"),k.value?(i(),m("button",{key:0,class:"btn block",onClick:e[18]||(e[18]=n=>G(s.value))},[u(t,{name:"trash"}),e[30]||(e[30]=D(" Delete ",-1))])):v("",!0),k.value?(i(),m("button",{key:1,class:"btn block secondary",onClick:V},[u(t,{name:"pencil",size:"1.5"}),e[31]||(e[31]=D(" Save ",-1))])):(i(),m("button",{key:2,class:"btn block secondary",onClick:$},"Add Event"))]),_:1})])])])])])}}}),Na=aa(Ua,[["__scopeId","data-v-01be08d3"]]);export{Na as default};
